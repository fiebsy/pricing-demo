<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anchor Positioning Test</title>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        .test-results {
            margin-top: 20px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 8px;
        }
        .success {
            color: #4ade80;
        }
        .error {
            color: #f87171;
        }
        .info {
            color: #60a5fa;
        }
        pre {
            background: #1a1a1a;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>ButtonAnimation V2 - Anchor Positioning Test</h1>
    <div id="test-results" class="test-results">
        <p>Testing anchor positioning on playground page...</p>
    </div>

    <script>
        async function testAnchorPositioning() {
            const results = document.getElementById('test-results');
            
            try {
                // Test scenarios
                const tests = [
                    {
                        name: "Initial State",
                        path: [],
                        expectedAnchors: 0,
                        expectedChildOffset: 0
                    },
                    {
                        name: "First Level Selection",
                        path: ["design"],
                        expectedAnchors: 0,
                        expectedChildOffset: 0
                    },
                    {
                        name: "Second Level Selection",
                        path: ["design", "figma"],
                        expectedAnchors: 1,
                        expectedChildOffset: 8
                    },
                    {
                        name: "Third Level Selection",
                        path: ["design", "figma", "components"],
                        expectedAnchors: 2,
                        expectedChildOffset: 16
                    },
                    {
                        name: "Fourth Level Selection",
                        path: ["design", "figma", "components", "buttons"],
                        expectedAnchors: 3,
                        expectedChildOffset: 24
                    }
                ];
                
                let output = '<h2>Test Results</h2>';
                
                for (const test of tests) {
                    const anchorCount = Math.max(0, test.path.length - 1);
                    const childOffset = anchorCount * 8; // peekOffset = 8
                    
                    const passed = anchorCount === test.expectedAnchors && 
                                   childOffset === test.expectedChildOffset;
                    
                    output += `
                        <div class="${passed ? 'success' : 'error'}">
                            <h3>${passed ? '‚úÖ' : '‚ùå'} ${test.name}</h3>
                            <p>Path: ${test.path.length > 0 ? test.path.join(' ‚Üí ') : '(none)'}</p>
                            <p>Anchors: ${anchorCount} (expected: ${test.expectedAnchors})</p>
                            <p>Child Offset: ${childOffset}px (expected: ${test.expectedChildOffset}px)</p>
                        </div>
                    `;
                }
                
                // Summary
                output += `
                    <div class="info">
                        <h3>üìä Positioning Formula</h3>
                        <pre>
anchoredCount = max(0, activePath.length - 1)
anchorOffset(n) = peekOffset * (n + 1)
childOffset = peekOffset * anchoredCount
                        </pre>
                        <p>With peekOffset = 8px:</p>
                        <ul>
                            <li>1st anchor: 8px</li>
                            <li>2nd anchor: 16px</li>
                            <li>3rd anchor: 24px</li>
                            <li>Children after n anchors: ${8}n px</li>
                        </ul>
                    </div>
                `;
                
                results.innerHTML = output;
                
                // Visual confirmation
                console.log('‚úÖ Anchor positioning test completed');
                console.log('Formula: childOffset = peekOffset * anchoredCount');
                console.log('Each anchored item stacks progressively at peekOffset intervals');
                
            } catch (error) {
                results.innerHTML = `<div class="error">Error: ${error.message}</div>`;
            }
        }
        
        // Run tests on load
        testAnchorPositioning();
    </script>
</body>
</html>