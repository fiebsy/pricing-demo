{"version":3,"file":"table-header.js","sourceRoot":"/","sources":["other-repos/demo-repo/src/components/ui/prod/data/sticky-data-table/components/header/table-header.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client'\n\n/**\n * StickyDataTable V2 - TableHeader Component\n *\n * Renders the table header with sort controls and sticky positioning.\n * Uses CSS Grid for perfect alignment with body rows.\n * Supports drag-and-drop column reordering for non-sticky columns.\n *\n * @module components/table-header\n */\n\nimport { memo } from 'react'\nimport { TABLE_CONFIG, ANIMATION_CONFIG } from '../../config'\nimport { generateGridTemplate, getHeaderOuterBorders, getHeaderOuterBorderStyles } from '../../utils'\nimport { useAutoColumnFlip } from '../../hooks'\nimport { HeaderCell } from './header-cell'\nimport { useHeaderDrag } from './use-header-drag'\nimport { DragClone, DragCursor } from './drag-clone'\nimport { DropIndicator } from './drop-indicator'\nimport type { TableHeaderProps } from './types'\n\n/**\n * Table header component\n *\n * Features:\n * - CSS Grid layout\n * - Sortable column headers\n * - Sticky positioning\n * - Select all checkbox\n * - Column animations\n * - Drag-and-drop column reordering (for non-sticky columns)\n */\nconst TableHeaderBase = ({\n  headerScrollRef,\n  headerHeight = TABLE_CONFIG.HEADER_HEIGHT,\n  stickyColumns,\n  scrollableColumns,\n  allColumns,\n  columnLabels,\n  stickyState,\n  borderConfig,\n  backgroundConfig,\n  borderRadius,\n  sortColumn,\n  sortDirection,\n  onSort,\n  columnChange,\n  leavingColumnKeys,\n  leavingColumns,\n  enteringColumnKeys,\n  selectionState,\n  enableColumnReorder = true,\n  onReorderColumns,\n  isColumnConfigHydrated = true,\n  lastDroppedKeyRef: externalDroppedKeyRef,\n  showScrollIndicator = false,\n  gradientBackgroundColor = 'var(--background-color-secondary_alt)',\n  dragCloneMode = 'inline',\n  dragSwapThreshold,\n  // Drag state from parent (when lifted to StickyDataTable level)\n  dragState: externalDragState,\n  columnRectsRef: externalColumnRectsRef,\n  isColumnDraggable: externalIsColumnDraggable,\n  handlePointerDown: externalHandlePointerDown,\n  handlePointerMove: externalHandlePointerMove,\n  handlePointerUp: externalHandlePointerUp,\n  handlePointerCancel: externalHandlePointerCancel,\n  getShiftDirection: externalGetShiftDirection,\n  getInlineOffset: externalGetInlineOffset,\n  getShiftAmount: externalGetShiftAmount,\n  cloneMode: externalCloneMode,\n  isInlineDragMode: externalIsInlineDragMode,\n}: TableHeaderProps) => {\n  // Generate grid template\n  const gridTemplate = generateGridTemplate(stickyColumns, scrollableColumns)\n  const outerBorderClasses = getHeaderOuterBorders(borderConfig)\n  const outerBorderStyles = getHeaderOuterBorderStyles(borderConfig)\n\n  // Drag-and-drop state and handlers - use external props if provided, otherwise use local hook\n  // This allows the hook to be lifted to parent level for sharing between header and body\n  const localDrag = useHeaderDrag({\n    headerScrollRef,\n    allColumns,\n    enableColumnReorder: externalDragState ? false : enableColumnReorder, // Disable local hook if external state provided\n    onReorderColumns,\n    externalDroppedKeyRef,\n    cloneMode: dragCloneMode,\n    dragSwapThreshold,\n  })\n\n  // Use external drag state if provided, otherwise use local\n  const dragState = externalDragState ?? localDrag.dragState\n  const columnRectsRef = externalColumnRectsRef ?? localDrag.columnRectsRef\n  const lastDroppedKeyRef = localDrag.lastDroppedKeyRef // Always use local for FLIP\n  const isColumnDraggable = externalIsColumnDraggable ?? localDrag.isColumnDraggable\n  const handlePointerDown = externalHandlePointerDown ?? localDrag.handlePointerDown\n  const handlePointerMove = externalHandlePointerMove ?? localDrag.handlePointerMove\n  const handlePointerUp = externalHandlePointerUp ?? localDrag.handlePointerUp\n  const handlePointerCancel = externalHandlePointerCancel ?? localDrag.handlePointerCancel\n  const getShiftDirection = externalGetShiftDirection ?? localDrag.getShiftDirection\n  const getInlineOffset = externalGetInlineOffset ?? localDrag.getInlineOffset\n  const getShiftAmount = externalGetShiftAmount ?? localDrag.getShiftAmount\n  const cloneMode = externalCloneMode ?? localDrag.cloneMode\n  const isInlineDragMode = externalIsInlineDragMode ?? (cloneMode === 'inline' && dragState.isDragging)\n\n  // Auto-FLIP: Smooth column shift animations (dragged column snaps, others animate)\n  const columnKeys = allColumns.map((col) => col.key)\n  useAutoColumnFlip(headerScrollRef, columnKeys, {\n    draggedKeyRef: lastDroppedKeyRef,\n    isHydrating: !isColumnConfigHydrated,\n  })\n\n  return (\n    <div\n      className=\"relative\"\n      onPointerMove={dragState.isDragging ? handlePointerMove : undefined}\n      onPointerUp={dragState.isDragging ? handlePointerUp : undefined}\n      onPointerCancel={dragState.isDragging ? handlePointerCancel : undefined}\n    >\n      {/* Gradient overlay - inside header, clipped INSIDE the border */}\n      {showScrollIndicator && (() => {\n        const borderWidth = borderConfig.showOuter ? 1 : 0\n        const innerRadius = Math.max(0, borderRadius - borderWidth)\n        return (\n          <div\n            className=\"pointer-events-none absolute inset-0 z-[25]\"\n            style={{\n              clipPath: `inset(${borderWidth}px ${borderWidth}px 0 ${borderWidth}px round ${innerRadius}px ${innerRadius}px 0 0)`,\n            }}\n          >\n            <div\n              className=\"absolute top-0 bottom-0 right-0 w-5\"\n              style={{\n                background: `linear-gradient(to left, ${gradientBackgroundColor} 0%, transparent 100%)`,\n              }}\n            />\n          </div>\n        )\n      })()}\n\n      {/* Main grid */}\n      <div\n        ref={headerScrollRef}\n        className={`grid w-full overflow-x-auto overflow-y-hidden ${outerBorderClasses} ${backgroundConfig.headerContainer} scrollbar-hidden`}\n        style={{\n          gridTemplateColumns: gridTemplate,\n          scrollbarWidth: 'none',\n          msOverflowStyle: 'none',\n          height: `${headerHeight}px`,\n          transition: columnChange\n            ? `background-color 0.125s ease, grid-template-columns ${ANIMATION_CONFIG.COLUMN_ANIMATION_DURATION}ms cubic-bezier(0.4, 0, 0.2, 1)`\n            : 'background-color 0.125s ease',\n          borderTopLeftRadius: `${borderRadius}px`,\n          borderTopRightRadius: `${borderRadius}px`,\n          willChange: 'scroll-position',\n          ...outerBorderStyles,\n        }}\n      >\n        {allColumns.map((col, colIndex) => {\n          const draggable = isColumnDraggable(col)\n          const isDragging = dragState.draggedKey === col.key\n          const label = columnLabels[col.key] || col.key\n          const shiftDirection = getShiftDirection(col.key, colIndex)\n          const inlineOffset = getInlineOffset(col.key)\n          const shiftAmount = getShiftAmount()\n\n          return (\n            <HeaderCell\n              key={col.key}\n              column={col}\n              label={label}\n              stickyState={stickyState}\n              borderConfig={borderConfig}\n              backgroundConfig={backgroundConfig}\n              sortColumn={sortColumn}\n              sortDirection={sortDirection}\n              onSort={onSort}\n              leavingColumnKeys={leavingColumnKeys}\n              enteringColumnKeys={enteringColumnKeys}\n              columnChange={columnChange}\n              selectionState={selectionState}\n              isDraggable={draggable}\n              isDragging={isDragging}\n              shiftDirection={shiftDirection}\n              inlineOffset={inlineOffset}\n              shiftAmount={shiftAmount}\n              isInlineMode={isInlineDragMode}\n              onPointerDown={draggable ? (e) => handlePointerDown(e, col.key, label) : undefined}\n            />\n          )\n        })}\n      </div>\n\n      {/* Drop indicator - only shown in 'floating' mode */}\n      {cloneMode === 'floating' && (\n        <DropIndicator\n          dragOverKey={dragState.dragOverKey}\n          dropSide={dragState.dropSide}\n          columnRectsRef={columnRectsRef}\n          headerScrollRef={headerScrollRef}\n        />\n      )}\n\n      {/* Floating drag clone - only shown in 'floating' mode */}\n      {cloneMode === 'floating' && <DragClone dragState={dragState} />}\n\n      {/* Global grabbing cursor during drag */}\n      <DragCursor isDragging={dragState.isDragging} />\n    </div>\n  )\n}\n\nexport const TableHeader = memo(TableHeaderBase)\nTableHeader.displayName = 'TableHeader'\n\n// Re-export types for consumers\nexport type { TableHeaderProps } from './types'\n"]}