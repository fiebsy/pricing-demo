{"version":3,"file":"use-columns.js","sourceRoot":"/","sources":["other-repos/demo-repo/src/components/ui/prod/data/sticky-data-table/hooks/column/use-columns.ts"],"names":[],"mappings":"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","sourcesContent":["'use client'\n\n/**\n * StickyDataTable V2 - Columns Hook\n *\n * Manages column visibility, ordering, and animations.\n * Handles dynamic column toggles with smooth transitions.\n *\n * @module hooks/use-columns\n */\n\nimport { useState, useMemo, useEffect, useCallback, useRef } from 'react'\nimport { ANIMATION_CONFIG } from '../../config'\nimport type { ColumnConfig, ColumnChange, ComputedColumn } from '../../types'\nimport { computeColumnOffsets, separateColumns, calculateTotalStickyWidth } from '../../utils'\n\ninterface UseColumnsProps {\n  columns: ColumnConfig[]\n  defaultHiddenColumns?: string[]\n  defaultVisibleColumns?: string[]\n}\n\ninterface UseColumnsReturn {\n  /** All columns with computed offsets */\n  allColumns: ComputedColumn[]\n  /** Visible sticky columns */\n  stickyColumns: ComputedColumn[]\n  /** Visible scrollable columns */\n  scrollableColumns: ComputedColumn[]\n  /** Set of visible column keys */\n  visibleColumnKeys: Set<string>\n  /** Set of columns animating out */\n  leavingColumnKeys: Set<string>\n  /** Full column data for leaving columns (for absolute positioning) */\n  leavingColumns: ComputedColumn[]\n  /** Set of columns animating in */\n  enteringColumnKeys: Set<string>\n  /** Current column change (for animation) */\n  columnChange: ColumnChange | null\n  /** Toggle column visibility */\n  toggleColumn: (columnKey: string) => void\n  /** Reset to default visibility */\n  resetColumns: () => void\n  /** Total width of sticky columns */\n  totalStickyWidth: number\n}\n\n/**\n * Hook for managing dynamic columns\n *\n * Features:\n * - Column visibility toggle with animation\n * - Automatic sticky offset calculation\n * - Animation state management\n * - Reset to default state\n */\nexport function useColumns({\n  columns,\n  defaultHiddenColumns = [],\n  defaultVisibleColumns,\n}: UseColumnsProps): UseColumnsReturn {\n  // Create initial visible set\n  // Priority: defaultVisibleColumns > defaultHiddenColumns > all columns\n  // Note: '__checkbox' is always included if it exists in columns\n  const initialVisibleKeys = useMemo(() => {\n    let visibleKeys: Set<string>\n    \n    if (defaultVisibleColumns && defaultVisibleColumns.length > 0) {\n      // Use explicit visible columns list\n      const visibleSet = new Set(defaultVisibleColumns)\n      visibleKeys = new Set(columns.map((c) => c.key).filter((key) => visibleSet.has(key)))\n    } else {\n      // Fall back to hidden columns approach (backward compatibility)\n      const hiddenSet = new Set(defaultHiddenColumns)\n      visibleKeys = new Set(columns.map((c) => c.key).filter((key) => !hiddenSet.has(key)))\n    }\n    \n    // Always include checkbox column if it exists\n    if (columns.some((c) => c.key === '__checkbox')) {\n      visibleKeys.add('__checkbox')\n    }\n    \n    return visibleKeys\n  }, [columns, defaultHiddenColumns, defaultVisibleColumns])\n\n  // State\n  const [visibleColumnKeys, setVisibleColumnKeys] = useState<Set<string>>(initialVisibleKeys)\n  const [leavingColumnKeys, setLeavingColumnKeys] = useState<Set<string>>(new Set())\n  const [leavingColumnsData, setLeavingColumnsData] = useState<ComputedColumn[]>([])\n  const [enteringColumnKeys, setEnteringColumnKeys] = useState<Set<string>>(new Set())\n  const [columnChange, setColumnChange] = useState<ColumnChange | null>(null)\n\n  // Track previous state for reset detection\n  const previousVisibleKeysRef = useRef<Set<string>>(initialVisibleKeys)\n\n  // Track current visible keys for sync comparison (avoids stale closure)\n  const visibleColumnKeysRef = useRef<Set<string>>(visibleColumnKeys)\n  useEffect(() => {\n    visibleColumnKeysRef.current = visibleColumnKeys\n  }, [visibleColumnKeys])\n\n  // Track computed columns for capturing leaving column data\n  const computedColumnsRef = useRef<ComputedColumn[]>([])\n\n  // ==========================================================================\n  // SYNC WITH EXTERNAL defaultVisibleColumns CHANGES\n  // ==========================================================================\n  // This effect allows external state (like useColumnConfiguration) to drive\n  // column visibility while preserving animations.\n  useEffect(() => {\n    if (!defaultVisibleColumns || defaultVisibleColumns.length === 0) return\n\n    const externalVisibleSet = new Set(defaultVisibleColumns)\n\n    // Always include checkbox column if it exists\n    if (columns.some((c) => c.key === '__checkbox')) {\n      externalVisibleSet.add('__checkbox')\n    }\n\n    // Use ref to get current state without adding to dependency array\n    const currentVisibleKeys = visibleColumnKeysRef.current\n\n    // Check if there's actually a difference\n    const currentKeys = [...currentVisibleKeys].sort().join(',')\n    const externalKeys = [...externalVisibleSet].sort().join(',')\n\n    if (currentKeys === externalKeys) return\n\n    // Calculate added/removed for animations\n    const removed = [...currentVisibleKeys].filter((k) => !externalVisibleSet.has(k))\n    const added = [...externalVisibleSet].filter((k) => !currentVisibleKeys.has(k))\n\n    // Mark removed columns as leaving for exit animation\n    if (removed.length > 0) {\n      // Capture leaving columns' computed data for absolute positioning\n      const leavingCols = computedColumnsRef.current.filter((c) => removed.includes(c.key))\n      if (leavingCols.length > 0) {\n        setLeavingColumnsData((existing) => [...existing, ...leavingCols])\n      }\n      setLeavingColumnKeys((leaving) => {\n        const updated = new Set(leaving)\n        removed.forEach((k) => updated.add(k))\n        return updated\n      })\n      const firstRemoved = removed[0]\n      if (firstRemoved) {\n        setColumnChange({\n          columnKey: firstRemoved,\n          action: 'removed',\n          timestamp: Date.now(),\n        })\n      }\n    }\n\n    // Mark added columns as entering for entry animation\n    if (added.length > 0) {\n      setEnteringColumnKeys(new Set(added))\n      const firstAdded = added[0]\n      if (firstAdded) {\n        setColumnChange({\n          columnKey: firstAdded,\n          action: 'added',\n          timestamp: Date.now(),\n        })\n      }\n    }\n\n    previousVisibleKeysRef.current = currentVisibleKeys\n    setVisibleColumnKeys(externalVisibleSet)\n  }, [defaultVisibleColumns, columns])\n\n  // Don't include leaving columns - they render as absolute overlays\n  // This allows the grid to shrink immediately, triggering FLIP for neighbors\n  const effectiveVisibleKeys = useMemo(() => {\n    return new Set(visibleColumnKeys)\n  }, [visibleColumnKeys])\n\n  // Filter and compute VISIBLE columns with proper offsets\n  const visibleColumns = useMemo(() => {\n    const visible = columns.filter((col) => effectiveVisibleKeys.has(col.key))\n    return computeColumnOffsets(visible)\n  }, [columns, effectiveVisibleKeys])\n\n  // Keep ref updated with VISIBLE columns (for capturing leaving column positions)\n  useEffect(() => {\n    computedColumnsRef.current = visibleColumns\n  }, [visibleColumns])\n\n  // Separate into sticky and scrollable\n  const { stickyColumns, scrollableColumns } = useMemo(\n    () => separateColumns(visibleColumns),\n    [visibleColumns]\n  )\n\n  // Calculate total sticky width\n  const totalStickyWidth = useMemo(\n    () => calculateTotalStickyWidth(stickyColumns),\n    [stickyColumns]\n  )\n\n  // Toggle column visibility\n  const toggleColumn = useCallback((columnKey: string) => {\n    setVisibleColumnKeys((prev) => {\n      const next = new Set(prev)\n      const wasVisible = prev.has(columnKey)\n\n      if (wasVisible) {\n        // Capture the leaving column's computed data for absolute positioning\n        const leavingCol = computedColumnsRef.current.find((c) => c.key === columnKey)\n        if (leavingCol) {\n          setLeavingColumnsData((existing) => [...existing, leavingCol])\n        }\n        // Mark as leaving for exit animation\n        setLeavingColumnKeys((leaving) => new Set(leaving).add(columnKey))\n        next.delete(columnKey)\n        setColumnChange({\n          columnKey,\n          action: 'removed',\n          timestamp: Date.now(),\n        })\n      } else {\n        // Remove from leaving if it was there\n        setLeavingColumnKeys((leaving) => {\n          const updated = new Set(leaving)\n          updated.delete(columnKey)\n          return updated\n        })\n        setLeavingColumnsData((existing) => existing.filter((c) => c.key !== columnKey))\n        // Mark as entering for entry animation\n        setEnteringColumnKeys((entering) => new Set(entering).add(columnKey))\n        next.add(columnKey)\n        setColumnChange({\n          columnKey,\n          action: 'added',\n          timestamp: Date.now(),\n        })\n      }\n\n      previousVisibleKeysRef.current = new Set(prev)\n      return next\n    })\n  }, [])\n\n  // Reset to default visibility\n  const resetColumns = useCallback(() => {\n    let defaultVisibleKeys: Set<string>\n    if (defaultVisibleColumns && defaultVisibleColumns.length > 0) {\n      // Use explicit visible columns list\n      const visibleSet = new Set(defaultVisibleColumns)\n      defaultVisibleKeys = new Set(columns.map((c) => c.key).filter((key) => visibleSet.has(key)))\n    } else {\n      // Fall back to hidden columns approach (backward compatibility)\n      const hiddenSet = new Set(defaultHiddenColumns)\n      defaultVisibleKeys = new Set(columns.map((c) => c.key).filter((key) => !hiddenSet.has(key)))\n    }\n\n    // Always include checkbox column if it exists\n    if (columns.some((c) => c.key === '__checkbox')) {\n      defaultVisibleKeys.add('__checkbox')\n    }\n\n    // Check if anything changed\n    const hasChanges =\n      previousVisibleKeysRef.current.size !== defaultVisibleKeys.size ||\n      Array.from(previousVisibleKeysRef.current).some((key) => !defaultVisibleKeys.has(key))\n\n    if (hasChanges) {\n      // Mark removed columns as leaving\n      const removedKeys = Array.from(previousVisibleKeysRef.current).filter(\n        (key) => !defaultVisibleKeys.has(key)\n      )\n      if (removedKeys.length > 0) {\n        setLeavingColumnKeys((leaving) => {\n          const updated = new Set(leaving)\n          removedKeys.forEach((key) => updated.add(key))\n          return updated\n        })\n      }\n\n      // Mark added columns as entering\n      const addedKeys = Array.from(defaultVisibleKeys).filter(\n        (key) => !previousVisibleKeysRef.current.has(key)\n      )\n      if (addedKeys.length > 0) {\n        setEnteringColumnKeys(new Set(addedKeys))\n      }\n\n      setColumnChange({\n        columnKey: 'reset',\n        action: 'added',\n        timestamp: Date.now(),\n      })\n    }\n\n    previousVisibleKeysRef.current = new Set(visibleColumnKeys)\n    setVisibleColumnKeys(defaultVisibleKeys)\n  }, [columns, defaultHiddenColumns, defaultVisibleColumns, visibleColumnKeys])\n\n  // Clear column change after animation\n  useEffect(() => {\n    if (columnChange) {\n      const timer = setTimeout(() => {\n        setColumnChange(null)\n      }, ANIMATION_CONFIG.COLUMN_CHANGE_CLEAR_DELAY)\n      return () => clearTimeout(timer)\n    }\n  }, [columnChange])\n\n  // Clear leaving columns after animation\n  useEffect(() => {\n    if (leavingColumnKeys.size > 0) {\n      const timer = setTimeout(() => {\n        setLeavingColumnKeys(new Set())\n        setLeavingColumnsData([])\n      }, ANIMATION_CONFIG.LEAVING_COLUMN_CLEAR_DELAY)\n      return () => clearTimeout(timer)\n    }\n  }, [leavingColumnKeys])\n\n  // Clear entering columns after animation\n  useEffect(() => {\n    if (enteringColumnKeys.size > 0) {\n      const timer = setTimeout(() => {\n        setEnteringColumnKeys(new Set())\n      }, ANIMATION_CONFIG.COLUMN_ENTER_DURATION)\n      return () => clearTimeout(timer)\n    }\n  }, [enteringColumnKeys])\n\n  return {\n    allColumns: visibleColumns,\n    stickyColumns,\n    scrollableColumns,\n    visibleColumnKeys,\n    leavingColumnKeys,\n    leavingColumns: leavingColumnsData,\n    enteringColumnKeys,\n    columnChange,\n    toggleColumn,\n    resetColumns,\n    totalStickyWidth,\n  }\n}\n\n\n"]}