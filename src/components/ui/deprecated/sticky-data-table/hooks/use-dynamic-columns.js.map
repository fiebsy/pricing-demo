{"version":3,"file":"use-dynamic-columns.js","sourceRoot":"/","sources":["other-repos/demo-repo/src/components/ui/deprecated/sticky-data-table/hooks/use-dynamic-columns.ts"],"names":[],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState } from 'react'\n\nimport { ANIMATION_CONFIG } from '../config'\nimport type { ColumnConfig } from '../types'\n\nexport interface ColumnChange {\n  columnKey: string\n  action: 'added' | 'removed'\n  timestamp: number\n}\n\n/**\n * Hook for managing dynamic columns in the table\n *\n * Implements FLIP-compatible animation timing:\n * 1. Column marked as leaving → leave animation starts\n * 2. After leave animation → column removed from DOM\n * 3. FLIP calculates neighbor shifts → neighbors animate\n *\n * @see /docs/frontend/ANIMATION-PREFERENCES.md (B-Tier FLIP pattern)\n */\nexport function useDynamicColumns(columnConfigs: ColumnConfig[]) {\n  const [visibleColumnKeys, setVisibleColumnKeys] = useState<Set<string>>(\n    () => new Set(columnConfigs.map((col) => col.key))\n  )\n  const [leavingColumnKeys, setLeavingColumnKeys] = useState<Set<string>>(new Set())\n  const [enteringColumnKeys, setEnteringColumnKeys] = useState<Set<string>>(new Set())\n  const [columnChange, setColumnChange] = useState<ColumnChange | null>(null)\n  const previousVisibleKeysRef = useRef<Set<string>>(new Set(columnConfigs.map((col) => col.key)))\n\n  // Refs for FLIP integration\n  const flipCallbackRef = useRef<(() => void) | null>(null)\n\n  // Include leaving columns in visible columns so they can animate out\n  const effectiveVisibleColumnKeys = useMemo(() => {\n    const combined = new Set(visibleColumnKeys)\n    leavingColumnKeys.forEach((key) => combined.add(key))\n    return combined\n  }, [visibleColumnKeys, leavingColumnKeys])\n\n  const visibleColumns = useMemo(() => {\n    return columnConfigs.filter((col) => effectiveVisibleColumnKeys.has(col.key))\n  }, [columnConfigs, effectiveVisibleColumnKeys])\n\n  const stickyColumns = useMemo(() => {\n    return visibleColumns.filter((col) => col.isSticky)\n  }, [visibleColumns])\n\n  const scrollableColumns = useMemo(() => {\n    return visibleColumns.filter((col) => !col.isSticky)\n  }, [visibleColumns])\n\n  /**\n   * Register a callback to be called after column removal animation completes\n   * Used by FLIP to trigger neighbor shift animations\n   */\n  const onColumnRemoved = useCallback((callback: () => void) => {\n    flipCallbackRef.current = callback\n  }, [])\n\n  /**\n   * Toggle column visibility with FLIP-compatible timing\n   */\n  const toggleColumn = useCallback((columnKey: string) => {\n    setVisibleColumnKeys((prev) => {\n      const next = new Set(prev)\n      const wasVisible = prev.has(columnKey)\n\n      if (wasVisible) {\n        // REMOVAL PATH - FLIP sequence:\n        // 1. Mark as leaving (starts leave animation)\n        setLeavingColumnKeys((prevLeaving) => new Set(prevLeaving).add(columnKey))\n\n        // 2. Remove from visible immediately (but stays in DOM via leavingColumnKeys)\n        next.delete(columnKey)\n\n        setColumnChange({\n          columnKey,\n          action: 'removed',\n          timestamp: Date.now(),\n        })\n      } else {\n        // ADDITION PATH:\n        // 1. Remove from leaving set if it was there (edge case: rapid toggle)\n        setLeavingColumnKeys((prevLeaving) => {\n          const updated = new Set(prevLeaving)\n          updated.delete(columnKey)\n          return updated\n        })\n\n        // 2. Mark as entering (starts enter animation)\n        setEnteringColumnKeys((prevEntering) => new Set(prevEntering).add(columnKey))\n\n        // 3. Add to visible\n        next.add(columnKey)\n\n        setColumnChange({\n          columnKey,\n          action: 'added',\n          timestamp: Date.now(),\n        })\n      }\n\n      previousVisibleKeysRef.current = new Set(prev)\n      return next\n    })\n  }, [])\n\n  /**\n   * Reset all columns to visible\n   */\n  const resetColumns = useCallback(() => {\n    const allKeys = new Set(columnConfigs.map((col) => col.key))\n    const currentlyHiddenKeys = Array.from(allKeys).filter((key) => !visibleColumnKeys.has(key))\n\n    // Mark all newly visible columns as entering\n    if (currentlyHiddenKeys.length > 0) {\n      setEnteringColumnKeys(new Set(currentlyHiddenKeys))\n    }\n\n    setColumnChange({\n      columnKey: 'reset',\n      action: 'added',\n      timestamp: Date.now(),\n    })\n\n    previousVisibleKeysRef.current = new Set(visibleColumnKeys)\n    setVisibleColumnKeys(allKeys)\n  }, [columnConfigs, visibleColumnKeys])\n\n  // Clear column change state after animation completes\n  useEffect(() => {\n    if (columnChange) {\n      const timer = setTimeout(() => {\n        setColumnChange(null)\n      }, ANIMATION_CONFIG.COLUMN_CHANGE_CLEAR_DELAY)\n      return () => clearTimeout(timer)\n    }\n  }, [columnChange])\n\n  // Clean up leaving columns after leave animation completes\n  // This triggers FLIP callback for neighbor shifting\n  useEffect(() => {\n    if (leavingColumnKeys.size > 0) {\n      const timer = setTimeout(() => {\n        // Call FLIP callback before clearing leaving state\n        // This allows FLIP to animate neighbors after column is removed\n        if (flipCallbackRef.current) {\n          flipCallbackRef.current()\n          flipCallbackRef.current = null\n        }\n        setLeavingColumnKeys(new Set())\n      }, ANIMATION_CONFIG.LEAVING_COLUMN_CLEAR_DELAY)\n      return () => clearTimeout(timer)\n    }\n  }, [leavingColumnKeys])\n\n  // Clean up entering columns after enter animation completes\n  useEffect(() => {\n    if (enteringColumnKeys.size > 0) {\n      const timer = setTimeout(() => {\n        setEnteringColumnKeys(new Set())\n      }, ANIMATION_CONFIG.COLUMN_ENTER_DURATION)\n      return () => clearTimeout(timer)\n    }\n  }, [enteringColumnKeys])\n\n  return {\n    visibleColumns,\n    stickyColumns,\n    scrollableColumns,\n    visibleColumnKeys,\n    toggleColumn,\n    resetColumns,\n    allAvailableColumns: columnConfigs,\n    columnChange, // Track which column was just added/removed\n    leavingColumnKeys, // Track columns that are animating out\n    enteringColumnKeys, // Track columns that are animating in\n    onColumnRemoved, // Register callback for FLIP integration\n  }\n}\n"]}