{"version":3,"file":"use-menu-navigation.js","sourceRoot":"/","sources":["other-repos/demo-repo/src/components/ui/deprecated/base/menu/hooks/use-menu-navigation.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Base UI Menu - Menu Navigation Hook\n *\n * Manages the navigation state for nested menus with optimized animations.\n *\n * Features:\n * - Uses ResizeObserver for accurate, automatic measurements\n * - Uses CSS Grid-based height animation (GPU-accelerated)\n * - Simplified state management with single source of truth\n *\n * @module base-ui/menu/hooks/use-menu-navigation\n */\n\nimport { useCallback, useEffect, useLayoutEffect, useRef, useState } from 'react'\nimport type { MenuItem, HeightTransitionConfig } from '../types'\nimport { STATE_RESET_DELAY } from '../config'\n\ninterface UseMenuNavigationOptions {\n  /** Menu items */\n  items: MenuItem[]\n  /** Whether the menu is open */\n  isOpen: boolean\n  /** Height transition configuration */\n  heightTransition: HeightTransitionConfig\n}\n\ninterface UseMenuNavigationReturn {\n  // Navigation state\n  menuStack: string[]\n  displayMenuStack: string[]\n  inSubmenu: boolean\n\n  // Height state\n  rootHeight: number\n  submenuHeight: number\n  activePanel: 'root' | 'submenu'\n  isTransitioning: boolean\n\n  // Refs for containers\n  rootMenuRef: React.RefObject<HTMLDivElement | null>\n  submenuRef: React.RefObject<HTMLDivElement | null>\n  containerRef: React.RefObject<HTMLDivElement | null>\n\n  // Navigation functions\n  navigateToSubmenu: (menuId: string) => void\n  navigateBack: (slideTransitionDuration?: number) => void\n\n  // Menu item helpers\n  getCurrentMenuItems: () => MenuItem[]\n  getCurrentMenuTitle: () => string | null\n\n  // CSS custom properties for animation\n  cssVars: Record<string, string>\n}\n\n/**\n * Hook for managing nested menu navigation with optimized height transitions\n */\nexport function useMenuNavigation({\n  items,\n  isOpen,\n  heightTransition,\n}: UseMenuNavigationOptions): UseMenuNavigationReturn {\n  // ============================================================================\n  // State\n  // ============================================================================\n\n  const [menuStack, setMenuStack] = useState<string[]>([])\n  const [displayMenuStack, setDisplayMenuStack] = useState<string[]>([])\n  const [rootHeight, setRootHeight] = useState(0)\n  const [submenuHeight, setSubmenuHeight] = useState(0)\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [activePanel, setActivePanel] = useState<'root' | 'submenu'>('root')\n\n  // ============================================================================\n  // Refs\n  // ============================================================================\n\n  const containerRef = useRef<HTMLDivElement>(null)\n  const rootMenuRef = useRef<HTMLDivElement>(null)\n  const submenuRef = useRef<HTMLDivElement>(null)\n  const wasOpenRef = useRef(false)\n  const resizeObserverRef = useRef<ResizeObserver | null>(null)\n  const transitionTimeoutRef = useRef<ReturnType<typeof setTimeout> | undefined>(undefined)\n\n  // ============================================================================\n  // Menu Item Helpers\n  // ============================================================================\n\n  const getCurrentMenuItems = useCallback((): MenuItem[] => {\n    let currentItems = items\n    for (const menuId of displayMenuStack) {\n      const menuItem = currentItems.find((item) => item.id === menuId)\n      if (menuItem && menuItem.type === 'submenu' && 'items' in menuItem) {\n        currentItems = menuItem.items\n      }\n    }\n    return currentItems\n  }, [items, displayMenuStack])\n\n  const getCurrentMenuTitle = useCallback((): string | null => {\n    // Use displayMenuStack so title stays stable during exit animation\n    if (displayMenuStack.length === 0) return null\n\n    let currentItems = items\n    let menuTitle = ''\n\n    for (const menuId of displayMenuStack) {\n      const menuItem = currentItems.find((item) => item.id === menuId)\n      if (menuItem && 'label' in menuItem) {\n        menuTitle = menuItem.label\n        if (menuItem.type === 'submenu' && 'items' in menuItem) {\n          currentItems = menuItem.items\n        }\n      }\n    }\n\n    return menuTitle || null\n  }, [items, displayMenuStack])\n\n  // ============================================================================\n  // ResizeObserver Setup\n  // ============================================================================\n\n  useLayoutEffect(() => {\n    if (!isOpen) return\n\n    const observer = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        const target = entry.target as HTMLElement\n        const height = entry.borderBoxSize?.[0]?.blockSize ?? entry.contentRect.height\n\n        if (target === rootMenuRef.current) {\n          setRootHeight(height)\n        } else if (target === submenuRef.current) {\n          setSubmenuHeight(height)\n        }\n      }\n    })\n\n    resizeObserverRef.current = observer\n\n    if (rootMenuRef.current) {\n      observer.observe(rootMenuRef.current)\n    }\n    if (submenuRef.current) {\n      observer.observe(submenuRef.current)\n    }\n\n    return () => {\n      observer.disconnect()\n      resizeObserverRef.current = null\n    }\n  }, [isOpen])\n\n  // Re-observe on content changes\n  useLayoutEffect(() => {\n    if (!isOpen || !resizeObserverRef.current) return\n\n    if (submenuRef.current && displayMenuStack.length > 0) {\n      resizeObserverRef.current.observe(submenuRef.current)\n    }\n  }, [isOpen, displayMenuStack, items])\n\n  // ============================================================================\n  // Display State Sync (only on menu open, not on menuStack changes)\n  // ============================================================================\n\n  useEffect(() => {\n    // Only sync when menu first opens, not on every menuStack change\n    // navigateToSubmenu and navigateBack handle displayMenuStack updates directly\n    if (isOpen && menuStack.length === 0 && displayMenuStack.length === 0) {\n      setActivePanel('root')\n    }\n  }, [isOpen, menuStack.length, displayMenuStack.length])\n\n  useEffect(() => {\n    if (!isOpen && wasOpenRef.current) {\n      const resetTimeout = setTimeout(() => {\n        setMenuStack([])\n        setDisplayMenuStack([])\n        setActivePanel('root')\n        setIsTransitioning(false)\n      }, STATE_RESET_DELAY)\n\n      return () => clearTimeout(resetTimeout)\n    }\n    wasOpenRef.current = isOpen\n  }, [isOpen])\n\n  // ============================================================================\n  // Transition Management\n  // ============================================================================\n\n  const startTransition = useCallback(() => {\n    if (transitionTimeoutRef.current) {\n      clearTimeout(transitionTimeoutRef.current)\n    }\n\n    setIsTransitioning(true)\n\n    transitionTimeoutRef.current = setTimeout(() => {\n      setIsTransitioning(false)\n    }, heightTransition.duration + 50)\n  }, [heightTransition.duration])\n\n  useEffect(() => {\n    return () => {\n      if (transitionTimeoutRef.current) {\n        clearTimeout(transitionTimeoutRef.current)\n      }\n    }\n  }, [])\n\n  // ============================================================================\n  // Navigation Functions\n  // ============================================================================\n\n  const navigateToSubmenu = useCallback((menuId: string) => {\n    const newStack = [...menuStack, menuId]\n    startTransition()\n    setMenuStack(newStack)\n    setDisplayMenuStack(newStack)\n    setActivePanel('submenu')\n  }, [menuStack, startTransition])\n\n  const navigateBack = useCallback((slideTransitionDuration = 300) => {\n    const newStack = menuStack.slice(0, -1)\n    startTransition()\n    setMenuStack(newStack)\n    setActivePanel(newStack.length > 0 ? 'submenu' : 'root')\n    // Delay displayMenuStack update so submenu content stays stable during slide-out\n    setTimeout(() => {\n      setDisplayMenuStack(newStack)\n    }, slideTransitionDuration)\n  }, [menuStack, startTransition])\n\n  // ============================================================================\n  // CSS Custom Properties\n  // ============================================================================\n\n  const cssVars = {\n    '--menu-root-height': `${rootHeight}px`,\n    '--menu-submenu-height': `${submenuHeight}px`,\n    '--menu-target-height': activePanel === 'root' ? `${rootHeight}px` : `${submenuHeight}px`,\n    '--menu-transition-duration': `${heightTransition.duration}ms`,\n    '--menu-transition-easing': heightTransition.easing,\n  }\n\n  // ============================================================================\n  // Return\n  // ============================================================================\n\n  return {\n    menuStack,\n    displayMenuStack,\n    inSubmenu: menuStack.length > 0, // Use menuStack for immediate slide trigger\n    rootHeight,\n    submenuHeight,\n    activePanel,\n    isTransitioning,\n    rootMenuRef,\n    submenuRef,\n    containerRef,\n    navigateToSubmenu,\n    navigateBack,\n    getCurrentMenuItems,\n    getCurrentMenuTitle,\n    cssVars,\n  }\n}\n"]}