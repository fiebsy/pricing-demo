{"version":3,"file":"use-shared-resize-observer.js","sourceRoot":"/","sources":["other-repos/demo-repo/src/components/ui/deprecated/controls/unified-control-panel/hooks/use-shared-resize-observer.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;GAWG;AAEH,YAAY,CAAA;AAbZ;;;;;;;;;;;GAWG;;;AAIH,iCAAgE;AAQhE,MAAM,oBAAoB;IAChB,QAAQ,GAA0B,IAAI,CAAA;IACtC,SAAS,GAAG,IAAI,GAAG,EAAgC,CAAA;IAE3D;QACE,sCAAsC;QACtC,IAAI,OAAO,MAAM,KAAK,WAAW,EAAE,CAAC;YAClC,IAAI,CAAC,QAAQ,GAAG,IAAI,cAAc,CAAC,CAAC,OAAO,EAAE,EAAE;gBAC7C,KAAK,MAAM,KAAK,IAAI,OAAO,EAAE,CAAC;oBAC5B,MAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,CAAA;oBACzD,IAAI,gBAAgB,EAAE,CAAC;wBACrB,gBAAgB,CAAC,OAAO,CAAC,CAAC,QAAQ,EAAE,EAAE,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAA;oBACzD,CAAC;gBACH,CAAC;YACH,CAAC,CAAC,CAAA;QACJ,CAAC;IACH,CAAC;IAED,OAAO,CAAC,OAAgB,EAAE,QAAwB;QAChD,IAAI,CAAC,IAAI,CAAC,QAAQ;YAAE,OAAO,GAAG,EAAE,GAAE,CAAC,CAAA;QAEnC,2CAA2C;QAC3C,IAAI,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;QAC3C,IAAI,CAAC,SAAS,EAAE,CAAC;YACf,SAAS,GAAG,IAAI,GAAG,EAAE,CAAA;YACrB,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,EAAE,SAAS,CAAC,CAAA;YACtC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAA;QAChC,CAAC;QACD,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAA;QAEvB,0BAA0B;QAC1B,OAAO,GAAG,EAAE;YACV,MAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,OAAO,CAAC,CAAA;YACpD,IAAI,gBAAgB,EAAE,CAAC;gBACrB,gBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAA;gBACjC,IAAI,gBAAgB,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC;oBAChC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAA;oBAC9B,IAAI,CAAC,QAAQ,EAAE,SAAS,CAAC,OAAO,CAAC,CAAA;gBACnC,CAAC;YACH,CAAC;QACH,CAAC,CAAA;IACH,CAAC;IAED,UAAU;QACR,IAAI,CAAC,QAAQ,EAAE,UAAU,EAAE,CAAA;QAC3B,IAAI,CAAC,SAAS,CAAC,KAAK,EAAE,CAAA;IACxB,CAAC;CACF;AAoH2B,oDAAoB;AAlHhD,qBAAqB;AACrB,IAAI,cAAc,GAAgC,IAAI,CAAA;AAEtD,SAAS,iBAAiB;IACxB,IAAI,CAAC,cAAc,EAAE,CAAC;QACpB,cAAc,GAAG,IAAI,oBAAoB,EAAE,CAAA;IAC7C,CAAC;IACD,OAAO,cAAc,CAAA;AACvB,CAAC;AA0GQ,8CAAiB;AA1F1B;;GAEG;AACH,SAAgB,cAAc,CAAC,UAAiC,EAAE;IAMhE,MAAM,EAAE,QAAQ,GAAG,CAAC,EAAE,GAAG,OAAO,CAAA;IAChC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,IAAA,gBAAQ,EAAqB,IAAI,CAAC,CAAA;IAC1D,MAAM,UAAU,GAAG,IAAA,cAAM,EAAqB,IAAI,CAAC,CAAA;IACnD,MAAM,UAAU,GAAG,IAAA,cAAM,EAAsB,IAAI,CAAC,CAAA;IACpD,MAAM,UAAU,GAAG,IAAA,cAAM,EAAuC,IAAI,CAAC,CAAA;IAErE,MAAM,GAAG,GAAG,IAAA,mBAAW,EACrB,CAAC,OAA2B,EAAE,EAAE;QAC9B,4BAA4B;QAC5B,IAAI,UAAU,CAAC,OAAO,EAAE,CAAC;YACvB,UAAU,CAAC,OAAO,EAAE,CAAA;YACpB,UAAU,CAAC,OAAO,GAAG,IAAI,CAAA;QAC3B,CAAC;QAED,UAAU,CAAC,OAAO,GAAG,OAAO,CAAA;QAE5B,IAAI,OAAO,EAAE,CAAC;YACZ,MAAM,QAAQ,GAAG,iBAAiB,EAAE,CAAA;YAEpC,MAAM,YAAY,GAAG,CAAC,KAA0B,EAAE,EAAE;gBAClD,MAAM,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC,WAAW,CAAA;gBAE3C,IAAI,QAAQ,GAAG,CAAC,EAAE,CAAC;oBACjB,IAAI,UAAU,CAAC,OAAO,EAAE,CAAC;wBACvB,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,CAAA;oBAClC,CAAC;oBACD,UAAU,CAAC,OAAO,GAAG,UAAU,CAAC,GAAG,EAAE;wBACnC,OAAO,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CAAA;oBAC5B,CAAC,EAAE,QAAQ,CAAC,CAAA;gBACd,CAAC;qBAAM,CAAC;oBACN,OAAO,CAAC,EAAE,KAAK,EAAE,MAAM,EAAE,CAAC,CAAA;gBAC5B,CAAC;YACH,CAAC,CAAA;YAED,UAAU,CAAC,OAAO,GAAG,QAAQ,CAAC,OAAO,CAAC,OAAO,EAAE,YAAY,CAAC,CAAA;YAE5D,mBAAmB;YACnB,MAAM,IAAI,GAAG,OAAO,CAAC,qBAAqB,EAAE,CAAA;YAC5C,OAAO,CAAC,EAAE,KAAK,EAAE,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,CAAA;QACrD,CAAC;aAAM,CAAC;YACN,OAAO,CAAC,IAAI,CAAC,CAAA;QACf,CAAC;IACH,CAAC,EACD,CAAC,QAAQ,CAAC,CACX,CAAA;IAED,qBAAqB;IACrB,IAAA,iBAAS,EAAC,GAAG,EAAE;QACb,OAAO,GAAG,EAAE;YACV,IAAI,UAAU,CAAC,OAAO,EAAE,CAAC;gBACvB,UAAU,CAAC,OAAO,EAAE,CAAA;YACtB,CAAC;YACD,IAAI,UAAU,CAAC,OAAO,EAAE,CAAC;gBACvB,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,CAAA;YAClC,CAAC;QACH,CAAC,CAAA;IACH,CAAC,EAAE,EAAE,CAAC,CAAA;IAEN,OAAO;QACL,GAAG;QACH,IAAI;QACJ,KAAK,EAAE,IAAI,EAAE,KAAK,IAAI,IAAI;QAC1B,MAAM,EAAE,IAAI,EAAE,MAAM,IAAI,IAAI;KAC7B,CAAA;AACH,CAAC;AAtED,wCAsEC;AAED;;GAEG;AACH,SAAgB,gBAAgB;IAI9B,MAAM,EAAE,GAAG,EAAE,MAAM,EAAE,GAAG,cAAc,EAAE,CAAA;IACxC,OAAO,EAAE,GAAG,EAAE,MAAM,EAAE,CAAA;AACxB,CAAC;AAND,4CAMC","sourcesContent":["/**\n * Shared Resize Observer\n *\n * A singleton ResizeObserver that efficiently observes multiple elements.\n * Instead of creating one observer per component, this shares a single\n * observer instance and dispatches callbacks to registered listeners.\n *\n * Usage:\n *   const { ref, height } = useElementSize()\n *   // ref is assigned to the element you want to observe\n *   // height updates when the element resizes\n */\n\n'use client'\n\nimport { useCallback, useEffect, useRef, useState } from 'react'\n\n// -----------------------------------------------------------------------------\n// Shared Observer Singleton\n// -----------------------------------------------------------------------------\n\ntype ResizeCallback = (entry: ResizeObserverEntry) => void\n\nclass SharedResizeObserver {\n  private observer: ResizeObserver | null = null\n  private callbacks = new Map<Element, Set<ResizeCallback>>()\n\n  constructor() {\n    // Lazy init observer only when needed\n    if (typeof window !== 'undefined') {\n      this.observer = new ResizeObserver((entries) => {\n        for (const entry of entries) {\n          const elementCallbacks = this.callbacks.get(entry.target)\n          if (elementCallbacks) {\n            elementCallbacks.forEach((callback) => callback(entry))\n          }\n        }\n      })\n    }\n  }\n\n  observe(element: Element, callback: ResizeCallback): () => void {\n    if (!this.observer) return () => {}\n\n    // Add callback to the set for this element\n    let callbacks = this.callbacks.get(element)\n    if (!callbacks) {\n      callbacks = new Set()\n      this.callbacks.set(element, callbacks)\n      this.observer.observe(element)\n    }\n    callbacks.add(callback)\n\n    // Return cleanup function\n    return () => {\n      const elementCallbacks = this.callbacks.get(element)\n      if (elementCallbacks) {\n        elementCallbacks.delete(callback)\n        if (elementCallbacks.size === 0) {\n          this.callbacks.delete(element)\n          this.observer?.unobserve(element)\n        }\n      }\n    }\n  }\n\n  disconnect(): void {\n    this.observer?.disconnect()\n    this.callbacks.clear()\n  }\n}\n\n// Singleton instance\nlet sharedObserver: SharedResizeObserver | null = null\n\nfunction getSharedObserver(): SharedResizeObserver {\n  if (!sharedObserver) {\n    sharedObserver = new SharedResizeObserver()\n  }\n  return sharedObserver\n}\n\n// -----------------------------------------------------------------------------\n// Hooks\n// -----------------------------------------------------------------------------\n\ninterface UseElementSizeOptions {\n  /** Debounce updates in ms (default: 0 = no debounce) */\n  debounce?: number\n}\n\ninterface ElementSize {\n  width: number\n  height: number\n}\n\n/**\n * Hook to observe an element's size using the shared ResizeObserver\n */\nexport function useElementSize(options: UseElementSizeOptions = {}): {\n  ref: React.RefCallback<HTMLElement>\n  size: ElementSize | null\n  width: number | null\n  height: number | null\n} {\n  const { debounce = 0 } = options\n  const [size, setSize] = useState<ElementSize | null>(null)\n  const elementRef = useRef<HTMLElement | null>(null)\n  const cleanupRef = useRef<(() => void) | null>(null)\n  const timeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null)\n\n  const ref = useCallback(\n    (element: HTMLElement | null) => {\n      // Cleanup previous observer\n      if (cleanupRef.current) {\n        cleanupRef.current()\n        cleanupRef.current = null\n      }\n\n      elementRef.current = element\n\n      if (element) {\n        const observer = getSharedObserver()\n\n        const handleResize = (entry: ResizeObserverEntry) => {\n          const { width, height } = entry.contentRect\n\n          if (debounce > 0) {\n            if (timeoutRef.current) {\n              clearTimeout(timeoutRef.current)\n            }\n            timeoutRef.current = setTimeout(() => {\n              setSize({ width, height })\n            }, debounce)\n          } else {\n            setSize({ width, height })\n          }\n        }\n\n        cleanupRef.current = observer.observe(element, handleResize)\n\n        // Get initial size\n        const rect = element.getBoundingClientRect()\n        setSize({ width: rect.width, height: rect.height })\n      } else {\n        setSize(null)\n      }\n    },\n    [debounce]\n  )\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (cleanupRef.current) {\n        cleanupRef.current()\n      }\n      if (timeoutRef.current) {\n        clearTimeout(timeoutRef.current)\n      }\n    }\n  }, [])\n\n  return {\n    ref,\n    size,\n    width: size?.width ?? null,\n    height: size?.height ?? null,\n  }\n}\n\n/**\n * Hook to observe content height only (common use case for collapse animations)\n */\nexport function useContentHeight(): {\n  ref: React.RefCallback<HTMLElement>\n  height: number | null\n} {\n  const { ref, height } = useElementSize()\n  return { ref, height }\n}\n\n// -----------------------------------------------------------------------------\n// Exports\n// -----------------------------------------------------------------------------\n\nexport { getSharedObserver, SharedResizeObserver }\n"]}